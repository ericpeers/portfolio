basePath: /
definitions:
  models.CompareRequest:
    properties:
      end_period:
        $ref: '#/definitions/models.FlexibleDate'
      portfolio_a:
        type: integer
      portfolio_b:
        type: integer
      start_period:
        $ref: '#/definitions/models.FlexibleDate'
    required:
    - end_period
    - portfolio_a
    - portfolio_b
    - start_period
    type: object
  models.CompareResponse:
    properties:
      absolute_similarity_score:
        type: number
      performance_metrics:
        $ref: '#/definitions/models.PerformanceMetrics'
      portfolio_a:
        $ref: '#/definitions/models.PortfolioSummary'
      portfolio_b:
        $ref: '#/definitions/models.PortfolioSummary'
      warnings:
        items:
          $ref: '#/definitions/models.Warning'
        type: array
    type: object
  models.CreatePortfolioRequest:
    properties:
      memberships:
        items:
          $ref: '#/definitions/models.MembershipRequest'
        type: array
      name:
        type: string
      objective:
        $ref: '#/definitions/models.Objective'
      owner_id:
        type: integer
      portfolio_type:
        $ref: '#/definitions/models.PortfolioType'
    required:
    - name
    - objective
    - owner_id
    - portfolio_type
    type: object
  models.DailyValue:
    properties:
      date:
        type: string
      value:
        type: number
    type: object
  models.ETFHoldingDTO:
    properties:
      name:
        type: string
      percentage:
        type: number
      security_id:
        type: integer
      symbol:
        type: string
    type: object
  models.ErrorResponse:
    properties:
      error:
        type: string
      message:
        type: string
    type: object
  models.ExpandedMembership:
    properties:
      allocation:
        description: Decimal allocation (0.60 = 60%)
        type: number
      security_id:
        type: integer
      sources:
        items:
          $ref: '#/definitions/models.MembershipSource'
        type: array
      symbol:
        type: string
    type: object
  models.FlexibleDate:
    properties:
      time.Time:
        type: string
    type: object
  models.GetDailyPricesResponse:
    properties:
      data_points:
        type: integer
      end_date:
        type: string
      prices:
        items:
          $ref: '#/definitions/models.PriceData'
        type: array
      security_id:
        type: integer
      start_date:
        type: string
      symbol:
        type: string
    type: object
  models.GetETFHoldingsResponse:
    properties:
      holdings:
        items:
          $ref: '#/definitions/models.ETFHoldingDTO'
        type: array
      name:
        type: string
      pull_date:
        type: string
      security_id:
        type: integer
      symbol:
        type: string
      warnings:
        items:
          $ref: '#/definitions/models.Warning'
        type: array
    type: object
  models.MembershipRequest:
    properties:
      percentage_or_shares:
        type: number
      security_id:
        type: integer
      ticker:
        type: string
    required:
    - percentage_or_shares
    type: object
  models.MembershipSource:
    properties:
      allocation:
        description: Proportion of this security's allocation from this source (sums
          to 1.0)
        type: number
      security_id:
        type: integer
      symbol:
        type: string
    type: object
  models.Objective:
    enum:
    - Aggressive Growth
    - Growth
    - Income Generation
    - Capital Preservation
    - Mixed Growth/Income
    type: string
    x-enum-varnames:
    - ObjectiveAggressiveGrowth
    - ObjectiveGrowth
    - ObjectiveIncomeGeneration
    - ObjectiveCapitalPreservation
    - ObjectiveMixedGrowthIncome
  models.PerformanceMetrics:
    properties:
      portfolio_a_metrics:
        $ref: '#/definitions/models.PortfolioPerformance'
      portfolio_b_metrics:
        $ref: '#/definitions/models.PortfolioPerformance'
    type: object
  models.Portfolio:
    properties:
      comment:
        type: string
      created_at:
        type: string
      ended_at:
        type: string
      id:
        type: integer
      name:
        type: string
      objective:
        $ref: '#/definitions/models.Objective'
      owner_id:
        type: integer
      portfolio_type:
        $ref: '#/definitions/models.PortfolioType'
      updated_at:
        type: string
    type: object
  models.PortfolioListItem:
    properties:
      created_at:
        type: string
      id:
        type: integer
      name:
        type: string
      objective:
        $ref: '#/definitions/models.Objective'
      portfolio_type:
        $ref: '#/definitions/models.PortfolioType'
      updated_at:
        type: string
    type: object
  models.PortfolioMembership:
    properties:
      percentage_or_shares:
        type: number
      portfolio_id:
        type: integer
      security_id:
        type: integer
    type: object
  models.PortfolioPerformance:
    properties:
      daily_values:
        items:
          $ref: '#/definitions/models.DailyValue'
        type: array
      dividends:
        type: number
      end_value:
        type: number
      gain_dollar:
        type: number
      gain_percent:
        type: number
      sharpe_ratios:
        $ref: '#/definitions/models.SharpeRatios'
      start_value:
        type: number
    type: object
  models.PortfolioSummary:
    properties:
      direct_membership:
        items:
          $ref: '#/definitions/models.ExpandedMembership'
        type: array
      expanded_memberships:
        items:
          $ref: '#/definitions/models.ExpandedMembership'
        type: array
      id:
        type: integer
      name:
        type: string
      type:
        $ref: '#/definitions/models.PortfolioType'
    type: object
  models.PortfolioType:
    enum:
    - Ideal
    - Active
    - Historic
    type: string
    x-enum-varnames:
    - PortfolioTypeIdeal
    - PortfolioTypeActive
    - PortfolioTypeHistoric
  models.PortfolioWithMemberships:
    properties:
      memberships:
        items:
          $ref: '#/definitions/models.PortfolioMembership'
        type: array
      portfolio:
        $ref: '#/definitions/models.Portfolio'
    type: object
  models.PriceData:
    properties:
      close:
        type: number
      date:
        type: string
      high:
        type: number
      low:
        type: number
      open:
        type: number
      security_id:
        type: integer
      volume:
        type: integer
    type: object
  models.SharpeRatios:
    properties:
      daily:
        type: number
      monthly:
        type: number
      three_month:
        type: number
      yearly:
        type: number
    type: object
  models.UpdatePortfolioRequest:
    properties:
      memberships:
        items:
          $ref: '#/definitions/models.MembershipRequest'
        type: array
      name:
        type: string
      objective:
        $ref: '#/definitions/models.Objective'
    type: object
  models.Warning:
    properties:
      code:
        $ref: '#/definitions/models.WarningCode'
      message:
        type: string
    type: object
  models.WarningCode:
    enum:
    - W1001
    - W1002
    - W4001
    type: string
    x-enum-comments:
      WarnPartialETFExpansion: ETF only partially expanded, normalized
      WarnStartDateAdjusted: start date adjusted to security inception date
      WarnUnresolvedETFHolding: individual unresolved holding
    x-enum-descriptions:
    - individual unresolved holding
    - ETF only partially expanded, normalized
    - start date adjusted to security inception date
    x-enum-varnames:
    - WarnUnresolvedETFHolding
    - WarnPartialETFExpansion
    - WarnStartDateAdjusted
host: localhost:8080
info:
  contact: {}
  description: A CRUD server for analyzing financial portfolios comprising stocks,
    bonds, and ETFs.
  title: Portfolio API
  version: "1.0"
paths:
  /admin/get_daily_prices:
    get:
      description: Fetch daily price data for a security by ticker or ID
      parameters:
      - description: Security ticker symbol
        in: query
        name: ticker
        type: string
      - description: Security ID
        in: query
        name: security_id
        type: integer
      - description: Start date (YYYY-MM-DD)
        in: query
        name: start_date
        required: true
        type: string
      - description: End date (YYYY-MM-DD)
        in: query
        name: end_date
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.GetDailyPricesResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Get daily prices for a security
      tags:
      - admin
  /admin/get_etf_holdings:
    get:
      description: Fetch holdings for an ETF or mutual fund by ticker or ID
      parameters:
      - description: ETF ticker symbol
        in: query
        name: ticker
        type: string
      - description: Security ID
        in: query
        name: security_id
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.GetETFHoldingsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Get ETF holdings
      tags:
      - admin
  /admin/sync-securities:
    post:
      description: Synchronize the securities database with AlphaVantage listing status
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Sync securities from AlphaVantage
      tags:
      - admin
  /portfolios:
    post:
      consumes:
      - application/json
      - multipart/form-data
      description: Create a new portfolio with optional memberships. Accepts JSON
        or multipart/form-data with a CSV file.
      parameters:
      - description: Portfolio to create (JSON)
        in: body
        name: portfolio
        schema:
          $ref: '#/definitions/models.CreatePortfolioRequest'
      - description: Portfolio metadata as JSON (multipart)
        in: formData
        name: metadata
        type: string
      - description: CSV file with ticker,percentage_or_shares columns (multipart)
        in: formData
        name: memberships
        type: file
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.PortfolioWithMemberships'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Create a new portfolio
      tags:
      - portfolios
  /portfolios/{id}:
    delete:
      description: Delete a portfolio by ID
      parameters:
      - description: Portfolio ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      security:
      - UserID: []
      summary: Delete a portfolio
      tags:
      - portfolios
    get:
      description: Retrieve a portfolio and its memberships by ID
      parameters:
      - description: Portfolio ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.PortfolioWithMemberships'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Get a portfolio by ID
      tags:
      - portfolios
    put:
      consumes:
      - application/json
      - multipart/form-data
      description: Update a portfolio's name and/or memberships. Accepts JSON or multipart/form-data
        with a CSV file.
      parameters:
      - description: Portfolio ID
        in: path
        name: id
        required: true
        type: integer
      - description: Portfolio updates (JSON)
        in: body
        name: portfolio
        schema:
          $ref: '#/definitions/models.UpdatePortfolioRequest'
      - description: Portfolio metadata as JSON (multipart)
        in: formData
        name: metadata
        type: string
      - description: CSV file with ticker,percentage_or_shares columns (multipart)
        in: formData
        name: memberships
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.PortfolioWithMemberships'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      security:
      - UserID: []
      summary: Update a portfolio
      tags:
      - portfolios
  /portfolios/compare:
    post:
      consumes:
      - application/json
      description: Compare two portfolios over a time period, showing membership differences
        and performance metrics
      parameters:
      - description: Comparison parameters
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.CompareRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.CompareResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Compare two portfolios
      tags:
      - portfolios
  /users/{user_id}/portfolios:
    get:
      description: Get all portfolios belonging to a user
      parameters:
      - description: User ID
        in: path
        name: user_id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.PortfolioListItem'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: List user's portfolios
      tags:
      - users
securityDefinitions:
  UserID:
    in: header
    name: X-User-ID
    type: apiKey
swagger: "2.0"
